<?php

namespace Nerdroid23\BladeIcomoon\Tests;

use Illuminate\Support\Facades\Config;

class CompilesIconsTest extends TestCase
{
    /** @test */
    public function it_compiles_a_single_anonymous_component()
    {
        $result = svg('icomoon-500px')->toHtml();

        // Note: the empty class here seems to be a Blade components bug.
        $expected = <<<'SVG'
        <!-- Generated by IcoMoon.io -->
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
        <title>500px</title>
        <path d="M7.906 21.025c0.006 0.019 0.175 0.475 0.269 0.706 0.525 1.244 1.281 2.369 2.244 3.331s2.081 1.719 3.331 2.244c1.294 0.544 2.663 0.825 4.075 0.825s2.788-0.275 4.075-0.825c1.25-0.525 2.369-1.281 3.331-2.244s1.719-2.081 2.244-3.331c0.544-1.294 0.825-2.663 0.825-4.075s-0.275-2.787-0.825-4.075c-0.525-1.25-1.281-2.369-2.244-3.331s-2.081-1.719-3.331-2.244c-1.294-0.544-2.663-0.825-4.075-0.825-1.431 0-2.863 0.287-4.131 0.825-1.019 0.431-2.744 1.537-3.75 2.581l-0.006 0.006v-8.625h14.481c0.525-0.006 0.525-0.744 0.525-0.981 0-0.244 0-0.975-0.531-0.981h-15.656c-0.425 0-0.688 0.356-0.688 0.681v12.131c0 0.394 0.488 0.675 0.944 0.769 0.887 0.188 1.088-0.094 1.306-0.394l0.031-0.037c0.331-0.494 1.363-1.531 1.375-1.544 1.613-1.613 3.769-2.5 6.075-2.5 2.294 0 4.444 0.887 6.056 2.5 1.619 1.619 2.512 3.763 2.512 6.037 0 2.281-0.887 4.431-2.5 6.038-1.587 1.587-3.813 2.5-6.094 2.5-1.544 0-3.037-0.413-4.319-1.194l0.006-7.375c0-0.981 0.425-2.056 1.144-2.863 0.819-0.925 1.944-1.431 3.175-1.431 1.188 0 2.3 0.45 3.131 1.269 0.819 0.813 1.275 1.9 1.275 3.056 0 2.462-1.938 4.394-4.412 4.394-0.475 0-1.344-0.212-1.381-0.219-0.5-0.15-0.713 0.544-0.781 0.775-0.269 0.881 0.137 1.056 0.219 1.081 0.794 0.25 1.319 0.294 2.006 0.294 3.494 0 6.337-2.844 6.337-6.338 0-3.469-2.844-6.287-6.331-6.287-1.712 0-3.319 0.656-4.525 1.838-1.15 1.131-1.806 2.637-1.806 4.137v0.038c-0.006 0.188-0.006 4.613-0.012 6.063l-0.006-0.006c-0.656-0.725-1.306-1.837-1.738-2.975-0.169-0.444-0.55-0.369-1.069-0.206-0.25 0.069-0.938 0.281-0.781 0.788v0zM15.35 19.294c0 0.212 0.194 0.4 0.313 0.506l0.037 0.038c0.2 0.194 0.387 0.294 0.563 0.294 0.144 0 0.231-0.069 0.262-0.1 0.087-0.081 1.075-1.087 1.175-1.181l1.106 1.1c0.1 0.113 0.212 0.175 0.344 0.175 0.175 0 0.369-0.106 0.569-0.313 0.475-0.488 0.238-0.75 0.125-0.875l-1.119-1.119 1.169-1.175c0.256-0.275 0.031-0.569-0.194-0.794-0.325-0.325-0.644-0.412-0.844-0.225l-1.163 1.162-1.175-1.175c-0.063-0.063-0.144-0.094-0.225-0.094-0.156 0-0.344 0.106-0.55 0.313-0.363 0.363-0.438 0.613-0.25 0.813l1.175 1.169-1.169 1.169c-0.106 0.1-0.156 0.206-0.15 0.313zM17.906 3.431c-1.875 0-3.875 0.381-5.338 1.012-0.156 0.063-0.25 0.188-0.269 0.362-0.019 0.169 0.025 0.388 0.137 0.675 0.094 0.231 0.331 0.85 0.8 0.669 1.5-0.575 3.162-0.888 4.669-0.888 1.712 0 3.375 0.338 4.938 0.994 1.244 0.525 2.413 1.287 3.688 2.388 0.094 0.081 0.194 0.119 0.294 0.119 0.25 0 0.488-0.244 0.694-0.475 0.337-0.381 0.575-0.7 0.238-1.019-1.219-1.15-2.55-2.013-4.2-2.712-1.788-0.744-3.694-1.125-5.65-1.125zM28.012 26.6v0c-0.225-0.225-0.419-0.356-0.587-0.406s-0.325-0.012-0.444 0.106l-0.113 0.113c-1.163 1.163-2.519 2.075-4.025 2.712-1.563 0.663-3.219 0.994-4.925 0.994-1.712 0-3.369-0.337-4.925-0.994-1.506-0.637-2.863-1.55-4.025-2.712-1.213-1.212-2.125-2.569-2.713-4.025-0.575-1.425-0.763-2.494-0.825-2.844-0.006-0.031-0.013-0.056-0.013-0.075-0.081-0.413-0.463-0.444-1.006-0.356-0.225 0.038-0.919 0.144-0.856 0.637v0.012c0.181 1.156 0.506 2.288 0.963 3.363 0.731 1.731 1.781 3.288 3.119 4.625s2.894 2.381 4.625 3.119c1.794 0.756 3.7 1.144 5.662 1.144s3.869-0.387 5.663-1.144c1.731-0.731 3.288-1.781 4.625-3.119 0 0 0.075-0.075 0.119-0.119 0.137-0.169 0.269-0.45-0.319-1.031z"></path>
        </svg>
        SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_add_classes_to_icons()
    {
        $result = svg('icomoon-aid-kit', 'w-4 h-4')->toHtml();

        $expected = <<<'SVG'
        <!-- Generated by IcoMoon.io -->
        <svg class="w-4 h-4" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
        <title>aid-kit</title>
        <path d="M28 8h-6v-4c0-1.1-0.9-2-2-2h-8c-1.1 0-2 0.9-2 2v4h-6c-2.2 0-4 1.8-4 4v16c0 2.2 1.8 4 4 4h24c2.2 0 4-1.8 4-4v-16c0-2.2-1.8-4-4-4zM12 4h8v4h-8v-4zM24 22h-6v6h-4v-6h-6v-4h6v-6h4v6h6v4z"></path>
        </svg>
        SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_add_styles_to_icons()
    {
        $result = svg('icomoon-angry2', ['style' => 'color: #000'])->toHtml();

        $expected = <<<'SVG'
        <!-- Generated by IcoMoon.io -->
        <svg style="color: #000" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
        <title>angry2</title>
        <path d="M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM18.003 11.891c0.064-1.483 1.413-2.467 2.55-3.036 1.086-0.543 2.16-0.814 2.205-0.826 0.536-0.134 1.079 0.192 1.213 0.728s-0.192 1.079-0.728 1.213c-0.551 0.139-1.204 0.379-1.779 0.667 0.333 0.357 0.537 0.836 0.537 1.363 0 1.105-0.895 2-2 2s-2-0.895-2-2c0-0.037 0.001-0.073 0.003-0.109zM8.030 8.758c0.134-0.536 0.677-0.862 1.213-0.728 0.045 0.011 1.119 0.283 2.205 0.826 1.137 0.569 2.486 1.553 2.55 3.036 0.002 0.036 0.003 0.072 0.003 0.109 0 1.105-0.895 2-2 2s-2-0.895-2-2c0-0.527 0.204-1.005 0.537-1.363-0.575-0.288-1.228-0.528-1.779-0.667-0.536-0.134-0.861-0.677-0.728-1.213zM22.003 24.398c-1.224-2.036-3.454-3.398-6.003-3.398s-4.779 1.362-6.003 3.398l-2.573-1.544c1.749-2.908 4.935-4.855 8.576-4.855s6.827 1.946 8.576 4.855l-2.573 1.544z"></path>
        </svg>
        SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_add_default_class_from_config()
    {
        Config::set('blade-icomoon.class', 'icon icomoon');

        $result = svg('icomoon-angry')->toHtml();

        $expected = <<<'SVG'
        <!-- Generated by IcoMoon.io -->
        <svg class="icon icomoon" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
        <title>angry</title>
        <path d="M16 32c8.837 0 16-7.163 16-16s-7.163-16-16-16-16 7.163-16 16 7.163 16 16 16zM16 3c7.18 0 13 5.82 13 13s-5.82 13-13 13-13-5.82-13-13 5.82-13 13-13zM22.003 24.398c-1.224-2.036-3.454-3.398-6.003-3.398s-4.779 1.362-6.003 3.398l-2.573-1.544c1.749-2.908 4.935-4.855 8.576-4.855s6.827 1.946 8.576 4.855l-2.573 1.544zM23.97 8.758c0.134 0.536-0.192 1.079-0.728 1.213-0.551 0.139-1.204 0.379-1.779 0.667 0.333 0.357 0.537 0.836 0.537 1.363 0 1.105-0.895 2-2 2s-2-0.895-2-2c0-0.037 0.001-0.073 0.003-0.109 0.064-1.483 1.413-2.467 2.55-3.036 1.086-0.543 2.159-0.814 2.205-0.826 0.536-0.134 1.079 0.192 1.213 0.728zM8.030 8.758c0.134-0.536 0.677-0.862 1.213-0.728 0.045 0.011 1.119 0.283 2.205 0.826 1.137 0.569 2.486 1.553 2.55 3.036 0.002 0.036 0.003 0.072 0.003 0.109 0 1.105-0.895 2-2 2s-2-0.895-2-2c0-0.527 0.204-1.005 0.537-1.363-0.575-0.288-1.228-0.528-1.779-0.667-0.536-0.134-0.861-0.677-0.728-1.213z"></path>
        </svg>
        SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_add_default_attributes_from_config()
    {
        Config::set('blade-icomoon.attributes', [
            'fill' => 'currentColor',
        ]);

        $result = svg('icomoon-angry')->toHtml();

        $expected = <<<'SVG'
        <!-- Generated by IcoMoon.io -->
        <svg fill="currentColor" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
        <title>angry</title>
        <path d="M16 32c8.837 0 16-7.163 16-16s-7.163-16-16-16-16 7.163-16 16 7.163 16 16 16zM16 3c7.18 0 13 5.82 13 13s-5.82 13-13 13-13-5.82-13-13 5.82-13 13-13zM22.003 24.398c-1.224-2.036-3.454-3.398-6.003-3.398s-4.779 1.362-6.003 3.398l-2.573-1.544c1.749-2.908 4.935-4.855 8.576-4.855s6.827 1.946 8.576 4.855l-2.573 1.544zM23.97 8.758c0.134 0.536-0.192 1.079-0.728 1.213-0.551 0.139-1.204 0.379-1.779 0.667 0.333 0.357 0.537 0.836 0.537 1.363 0 1.105-0.895 2-2 2s-2-0.895-2-2c0-0.037 0.001-0.073 0.003-0.109 0.064-1.483 1.413-2.467 2.55-3.036 1.086-0.543 2.159-0.814 2.205-0.826 0.536-0.134 1.079 0.192 1.213 0.728zM8.030 8.758c0.134-0.536 0.677-0.862 1.213-0.728 0.045 0.011 1.119 0.283 2.205 0.826 1.137 0.569 2.486 1.553 2.55 3.036 0.002 0.036 0.003 0.072 0.003 0.109 0 1.105-0.895 2-2 2s-2-0.895-2-2c0-0.527 0.204-1.005 0.537-1.363-0.575-0.288-1.228-0.528-1.779-0.667-0.536-0.134-0.861-0.677-0.728-1.213z"></path>
        </svg>
        SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_merge_default_class_from_config()
    {
        Config::set('blade-icomoon.class', 'icon icomoon');

        $result = svg('icomoon-appleinc', 'icomoon-sm')->toHtml();

        $expected = <<<'SVG'
        <!-- Generated by IcoMoon.io -->
        <svg class="icon icomoon icomoon-sm" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
        <title>appleinc</title>
        <path d="M24.734 17.003c-0.040-4.053 3.305-5.996 3.454-6.093-1.88-2.751-4.808-3.127-5.851-3.171-2.492-0.252-4.862 1.467-6.127 1.467-1.261 0-3.213-1.43-5.28-1.392-2.716 0.040-5.221 1.579-6.619 4.012-2.822 4.897-0.723 12.151 2.028 16.123 1.344 1.944 2.947 4.127 5.051 4.049 2.026-0.081 2.793-1.311 5.242-1.311s3.138 1.311 5.283 1.271c2.18-0.041 3.562-1.981 4.897-3.931 1.543-2.255 2.179-4.439 2.216-4.551-0.048-0.022-4.252-1.632-4.294-6.473zM20.705 5.11c1.117-1.355 1.871-3.235 1.665-5.11-1.609 0.066-3.559 1.072-4.713 2.423-1.036 1.199-1.942 3.113-1.699 4.951 1.796 0.14 3.629-0.913 4.747-2.264z"></path>
        </svg>
        SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_merge_default_attributes_from_config()
    {
        Config::set('blade-icomoon.attributes', [
            'fill' => 'currentColor',
        ]);

        $result = svg('icomoon-appleinc', '', [
            'width' => 32,
            'height' => 32,
        ])->toHtml();

        $expected = <<<'SVG'
        <!-- Generated by IcoMoon.io -->
        <svg width="32" height="32" fill="currentColor" version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
        <title>appleinc</title>
        <path d="M24.734 17.003c-0.040-4.053 3.305-5.996 3.454-6.093-1.88-2.751-4.808-3.127-5.851-3.171-2.492-0.252-4.862 1.467-6.127 1.467-1.261 0-3.213-1.43-5.28-1.392-2.716 0.040-5.221 1.579-6.619 4.012-2.822 4.897-0.723 12.151 2.028 16.123 1.344 1.944 2.947 4.127 5.051 4.049 2.026-0.081 2.793-1.311 5.242-1.311s3.138 1.311 5.283 1.271c2.18-0.041 3.562-1.981 4.897-3.931 1.543-2.255 2.179-4.439 2.216-4.551-0.048-0.022-4.252-1.632-4.294-6.473zM20.705 5.11c1.117-1.355 1.871-3.235 1.665-5.11-1.609 0.066-3.559 1.072-4.713 2.423-1.036 1.199-1.942 3.113-1.699 4.951 1.796 0.14 3.629-0.913 4.747-2.264z"></path>
        </svg>
        SVG;

        $this->assertSame($expected, $result);
    }

    /** @test */
    public function it_can_use_another_prefix_from_config()
    {
        Config::set('blade-icomoon.prefix', 'im');

        $result = svg('im-appleinc')->toHtml();

        $expected = <<<'SVG'
        <!-- Generated by IcoMoon.io -->
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
        <title>appleinc</title>
        <path d="M24.734 17.003c-0.040-4.053 3.305-5.996 3.454-6.093-1.88-2.751-4.808-3.127-5.851-3.171-2.492-0.252-4.862 1.467-6.127 1.467-1.261 0-3.213-1.43-5.28-1.392-2.716 0.040-5.221 1.579-6.619 4.012-2.822 4.897-0.723 12.151 2.028 16.123 1.344 1.944 2.947 4.127 5.051 4.049 2.026-0.081 2.793-1.311 5.242-1.311s3.138 1.311 5.283 1.271c2.18-0.041 3.562-1.981 4.897-3.931 1.543-2.255 2.179-4.439 2.216-4.551-0.048-0.022-4.252-1.632-4.294-6.473zM20.705 5.11c1.117-1.355 1.871-3.235 1.665-5.11-1.609 0.066-3.559 1.072-4.713 2.423-1.036 1.199-1.942 3.113-1.699 4.951 1.796 0.14 3.629-0.913 4.747-2.264z"></path>
        </svg>
        SVG;

        $this->assertSame($expected, $result);
    }
}
